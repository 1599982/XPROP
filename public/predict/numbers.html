<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calculadora en Señas</title>

    <!-- Fuente Konkhmer Sleokchher -->
    <link
      href="https://fonts.googleapis.com/css2?family=Konkhmer+Sleokchher&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="{{ url_for('static', filename='styles/index.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/predict/alphabet.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/predict/numbers.css') }}">

  </head>
  <body>
    <!-- Título -->
    <h2 class="title">Calculadora en Señas</h2>

<!-- Único cuadro azul -->
<div class="content-box">
  <!-- Sidebar -->
	<div class="sidebar">
		<button onclick="window.location.href='/'">
			<img src="{{ url_for('static', filename='images/icons/home.png') }}" alt="Inicio">
		</button>
		<button onclick="window.location.href='/previsione/alfabeto'">
			<img src="{{ url_for('static', filename='images/icons/letters.png') }}" alt="Letras">
		</button>
		<button onclick="window.location.href='/previsione/numeri'">
			<img src="{{ url_for('static', filename='images/icons/numbers.png') }}" alt="Número">
		</button>
		<button onclick="window.location.href='/allenamiento'">
			<img src="{{ url_for('static', filename='images/icons/training.png') }}" alt="Entrenando">
		</button>
	</div>


            <!-- Contenido principal -->
  <div class="main-content">
    <!-- Sección izquierda -->
    <div class="left-section">
      <!-- Detectores -->
      <div class="detectores">
        <!-- Detector 1: Mano Izquierda - Números -->
        <div class="detector">
          <div class="detector-body">
            <div class="detected-letter" id="detected-letter-left">-</div>
            <div class="progress-bar">
              <div class="progress" id="letter-progress-left" style="width: 0%;">0%</div>
            </div>
          </div>
          <div class="detector-footer">Reconocimiento Números</div>
        </div>

        <!-- Detector 2: Mano Derecha - Control -->
        <div class="detector">
          <div class="detector-body">
            <div class="hand-state" id="hand-state-right">ABIERTA</div>
            <div class="progress-bar">
              <div class="progress" id="hand-progress-right" style="width: 0%;">0%</div>
            </div>
          </div>
          <div class="detector-footer">Control de Escritura</div>
        </div>
      </div>
      <!-- Números y Operaciones -->
		<div class="abecedario-container">
		    <div class="alphabet-grid" id="alphabet-grid">
				<!-- Números 0-9 -->
				<div class="letter-item" data-letter="0">
					<img src="{{ url_for('static', filename='images/icons/numbers/0.png') }}" alt="0">
					<span>0</span>
				</div>
				<div class="letter-item" data-letter="1">
					<img src="{{ url_for('static', filename='images/icons/numbers/1.png') }}" alt="1">
					<span>1</span>
				</div>
				<div class="letter-item" data-letter="2">
					<img src="{{ url_for('static', filename='images/icons/numbers/2.png') }}" alt="2">
					<span>2</span>
				</div>
				<div class="letter-item" data-letter="3">
					<img src="{{ url_for('static', filename='images/icons/numbers/3.png') }}" alt="3">
					<span>3</span>
				</div>
				<div class="letter-item" data-letter="4">
					<img src="{{ url_for('static', filename='images/icons/numbers/4.png') }}" alt="4">
					<span>4</span>
				</div>
				<div class="letter-item" data-letter="5">
					<img src="{{ url_for('static', filename='images/icons/numbers/5.png') }}" alt="5">
					<span>5</span>
				</div>
				<div class="letter-item" data-letter="6">
					<img src="{{ url_for('static', filename='images/icons/numbers/6.png') }}" alt="6">
					<span>6</span>
				</div>
				<div class="letter-item" data-letter="7">
					<img src="{{ url_for('static', filename='images/icons/numbers/7.png') }}" alt="7">
					<span>7</span>
				</div>
				<div class="letter-item" data-letter="8">
					<img src="{{ url_for('static', filename='images/icons/numbers/8.png') }}" alt="8">
					<span>8</span>
				</div>
				<div class="letter-item" data-letter="9">
					<img src="{{ url_for('static', filename='images/icons/numbers/9.png') }}" alt="9">
					<span>9</span>
				</div>

				<!-- Operaciones Matemáticas -->
				<div class="letter-item operation-item" data-letter="S">
					<img src="{{ url_for('static', filename='images/icons/letters/S.png') }}" alt="S">
					<div class="operation-symbol">+</div>
				</div>
				<div class="letter-item operation-item" data-letter="R">
					<img src="{{ url_for('static', filename='images/icons/letters/R.png') }}" alt="R">
					<div class="operation-symbol">-</div>
				</div>
				<div class="letter-item operation-item" data-letter="M">
					<img src="{{ url_for('static', filename='images/icons/letters/M.png') }}" alt="M">
					<div class="operation-symbol">×</div>
				</div>
				<div class="letter-item operation-item" data-letter="D">
					<img src="{{ url_for('static', filename='images/icons/letters/D.png') }}" alt="D">
					<div class="operation-symbol">÷</div>
				</div>
				<div class="letter-item operation-item equal-item" data-letter="I">
					<img src="{{ url_for('static', filename='images/icons/letters/I.png') }}" alt="I">
					<span>=</span>
				</div>
		    </div>
		</div>
    </div>

         <!-- Sección derecha: Cámara -->
    <div class="right-section">
      <!-- Cuadro de letras detectadas -->
      <div class="detected-text-container">
        <div class="detected-text-header">
          <span>Operación Detectada</span>
          <div class="header-controls">
            <span id="write-status" class="write-status">✅ Listo</span>
            <button id="clear-text" class="clear-btn">Limpiar</button>
          </div>
        </div>
        <div class="detected-text-box" id="detected-text-box">
          <span id="detected-text"></span>
        </div>
      </div>

      <div class="camera-area">
        <div class="camera-placeholder">
          <video id="video" autoplay muted></video>
          <canvas id="canvas" width="450" height="400"></canvas>
        </div>
      </div>
    </div>
  </div>
</div>

    <!-- Librerías necesarias para MediaPipe -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
    <script src="{{ url_for('static', filename='predict.numbers.js') }}" type="module"></script>

    <style>
      .operation-item {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-color: #5a67d8;
      }

      .operation-item img {
        width: 32px;
        height: 32px;
        object-fit: contain;
        margin-bottom: 5px;
        filter: brightness(0) invert(1);
      }

      .operation-symbol {
        font-size: 1.5em;
        font-weight: bold;
        color: white;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        margin-bottom: 0;
        line-height: 1;
      }



      .operation-item:hover {
        background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
      }

      .equal-item {
        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%) !important;
        border-color: #e55039 !important;
      }

      .equal-item:hover {
        background: linear-gradient(135deg, #e55039 0%, #c23616 100%) !important;
      }

      .equal-item img {
        width: 32px;
        height: 32px;
        object-fit: contain;
        margin-bottom: 5px;
        filter: brightness(0) invert(1);
      }

      .equal-item span {
        color: white !important;
        font-size: 1.2em;
        font-weight: bold;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      }

      /* Error states for write status */
      .write-status.error {
        background-color: #ff4757 !important;
        color: white !important;
        animation: shake 0.5s ease-in-out;
      }

      .write-status.warning {
        background-color: #ffa502 !important;
        color: white !important;
        animation: pulse 1s infinite;
      }

      /* Animations for feedback */
      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
        20%, 40%, 60%, 80% { transform: translateX(5px); }
      }

      @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.7; }
      }

      /* Visual feedback for invalid operations */
      .detected-text-box.error {
        border: 2px solid #ff4757 !important;
        background-color: #ffe6e6 !important;
        animation: shake 0.5s ease-in-out;
      }

      .detected-text-box.success {
        border: 2px solid #2ed573 !important;
        background-color: #e6ffe6 !important;
        animation: flash-green 0.5s ease-in-out;
      }

      @keyframes flash-green {
        0%, 100% { background-color: white; }
        50% { background-color: #e6ffe6; }
      }

      /* Disabled state for operation items when invalid */
      .letter-item.disabled {
        opacity: 0.5;
        cursor: not-allowed;
        filter: grayscale(70%);
        transform: none !important;
      }

      .letter-item.disabled:hover {
        transform: none !important;
        background: initial !important;
      }

      /* Success feedback for calculations */
      .detected-text-box.calculated {
        background: linear-gradient(135deg, #e6ffe6 0%, #ccffcc 100%);
        border: 2px solid #2ed573;
        animation: glow-success 1s ease-in-out;
      }

      @keyframes glow-success {
        0%, 100% { box-shadow: 0 0 5px rgba(46, 213, 115, 0.3); }
        50% { box-shadow: 0 0 20px rgba(46, 213, 115, 0.8); }
      }
    </style>
  </body>
</html>
